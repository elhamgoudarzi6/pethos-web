<p-toast position="center"></p-toast>

<div class="header-image-wrapper">
  <div class="bg"></div>
  <div class="mask"></div>
  <div class="header-image-content mh-200">
    <p class="desc">املاک ثبت شده</p>
  </div>
</div>
<section class="breadcrumbs">
  <div class="container">
    <ol class="pb-0">
      <li><a routerLink="/"><i class="pi pi-home"></i></a></li>
      <li>همه ی املاک</li>
    </ol>
  </div>
</section>
<div class="px-3 my-4">
  <div class="theme-container">
    <div class="row m-0 justify-content-center">
      <div class="d-none d-md-block col-lg-3 col-md-3 site-card py-4">
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-dropdown [options]="transactionTypes" placeholder="نوع آگهی" [(ngModel)]="selectedtransactionType"
              optionLabel="title"></p-dropdown>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-dropdown [options]="propertyTypes" placeholder="نوع کاربری" (onChange)="onTypeChange($event)"
              optionLabel="title"></p-dropdown>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-dropdown [options]="subPropertyTypes" placeholder="نوع ملک" (onChange)="onSubTypeChange($event)"
              optionLabel="title"></p-dropdown>
          </div>
        </div>

        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-multiSelect [options]="features" (onChange)="onChangeFeature($event)" placeholder="ویژگی ها"
              [(ngModel)]="selectedFeatures" optionLabel="title"></p-multiSelect>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-multiSelect [options]="conditions" (onChange)="onChangeCondition($event)" placeholder="شرایط"
              [(ngModel)]="selectedConditions" optionLabel="title"></p-multiSelect>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-multiSelect [options]="exchanges" (onChange)="onChangeExchange($event)" placeholder="معاوضه با"
              [(ngModel)]="selectedExchanges" optionLabel="title"></p-multiSelect>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-6">
            <p-multiSelect [options]="baths" (onChange)="onChangeBath($event)" placeholder="حمام"
              [(ngModel)]="selectedbaths" optionLabel="title"></p-multiSelect>
          </div>
          <div class="col-6">
            <p-multiSelect [options]="rooms" (onChange)="onChangeRoom($event)" placeholder="اتاق خواب"
              [(ngModel)]="selectedrooms" optionLabel="title"></p-multiSelect>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-6">
            <p-inputNumber (onInput)="onInputareaFrom($event)" [(ngModel)]="areaFrom" placeholder="متراژ از"
              mode="decimal" [minFractionDigits]="0">
            </p-inputNumber>
          </div>
          <div class="col-6">
            <p-inputNumber (onInput)="onInputareaTo($event)" [(ngModel)]="areaTo" placeholder="متراژ تا" mode="decimal"
              [minFractionDigits]="0">
            </p-inputNumber>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-6">
            <p-inputNumber (onInput)="onInputpriceFrom($event)" [(ngModel)]="priceFrom" placeholder="قیمت از"
              mode="decimal" [minFractionDigits]="0">
            </p-inputNumber>
          </div>
          <div class="col-6">
            <p-inputNumber (onInput)="onInputpriceTo($event)" [(ngModel)]="priceTo" placeholder="قیمت تا" mode="decimal"
              [minFractionDigits]="0">
            </p-inputNumber>
          </div>
        </div>
        <div class="row justify-content-center pb-3" [formGroup]="form">
          <div class="col-12">
            <p-chips placeholder=" کلمات کلیدی " [(ngModel)]="keywords" (onAdd)="onAddKey($event)"
              (onRemove)="onRemoveKey($event)" [addOnTab]="true" [addOnBlur]="true">
            </p-chips>
          </div>
        </div>
        <!-- <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-checkbox [binary]="true" label="نمایش تخفیف دار ها" [(ngModel)]="hasDiscount" class="w-100"></p-checkbox>
          </div>
        </div> -->
        <div class="row justify-content-center p-3">
          <div class="col-6">
            <button (click)="searchProperty()" class="green-button" type="submit">
              <i class="fa fa-search"></i>
              جستجو
            </button>
          </div>
          <div class="col-6">
            <button (click)="goProperty(0, 0, 0)" class="white-flat-button" type="submit"> همه املاک
            </button>
          </div>
        </div>
      </div>

      <div class="col-sm-12 col-lg-8 col-md-8 site-box mr-0 mr-md-4">
        <div class="row justify-content-center site-card d-flex flex-row">
          <div class="d-none d-md-block col align-self-center text-right">
            <p class="mb-0">{{ total }} مورد یافت شد.</p>
          </div>
          <div class="col align-self-center text-right text-md-left">
            <div class="dropdown">
              <button class="btn btn-link primary-color dropdown-toggle" type="button" id="dropdownMenuButton"
                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                مرتب سازی
              </button>
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item" (click)="onChangeSortID(1)" [ngClass]="sortID === 1 ? 'is-active' : ''">
                  جدیدترین</a>
                <a class="dropdown-item" (click)="onChangeSortID(2)" [ngClass]="sortID === 2 ? 'is-active' : ''">
                  ارزان ترین</a>
                <a class="dropdown-item" (click)="onChangeSortID(3)" [ngClass]="sortID === 3 ? 'is-active' : ''">
                  گران ترین</a>
              </div>
            </div>
          </div>
          <div class="d-sm-block d-md-none d-lg-none d-xl-nonecol align-self-center"
            (click)="displayMobileFilter = true">
            <a>
              <span class="primary-color" style="font-family: IRANSans_Bold;"> نمایش فیلترها </span>
              <i class="fa fa-filter primary-color pl-3" aria-hidden="true"></i>
            </a>
          </div>
        </div>
        <div class="row justify-content-right mt-3">
          <div class="item col-xs-12 col-sm-6 col-md-6 col-lg-4 col-xl-4 p-0" *ngFor="
              let item of properties
                | paginate
                  : {
                      itemsPerPage: pageSize,
                      currentPage: page,
                      totalItems: total
                    }
            ">
            <div class="
                property-card property-item
                m-2
                grid-item
                column-4
                full-width-page
              ">
              <div class="thumbnail-section">
                <div class="price-type">
                  <span *ngIf="item.priceType ==='به قیمت'" class="green font-iran-bold">{{ item.priceType }}</span>
                  <span *ngIf="item.priceType ==='مناسب'"  class="orange font-iran-bold">{{ item.priceType }}</span>
                </div>
                <div class="property-status">
                  <span class="green font-iran-bold">{{ item.TransactionType[0].title }}</span>
                </div>
                <div class="property-image">
                  <img *ngIf="item.image === null || item.image === ''" src="../../../assets/images/user-default.png"
                    class="w-100" height="200px" />
                  <img *ngIf="item.image !== null" [src]="item.image" class="w-100" height="200px" />
                </div>
                <div class="control-icons">
                  <button class="add-to-favorite-button" title="افزودن به علاقه مندی ها"
                    (click)="addToFavorites(item._id)">
                    <svg width="18" height="18" version="1.1" xmlns="http://www.w3.org/2000/svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1000 1000"
                      enable-background="new 0 0 1000 1000" xml:space="preserve">
                      <metadata> Svg Vector Icons : http://www.onlinewebfonts.com/icon </metadata>
                      <g>
                        <g transform="translate(0.000000,426.000000) scale(0.100000,-0.100000)">
                          <path
                            d="M2244.2,3353.9C1208.7,3167,393.2,2388.4,161.5,1368.5C-37,486.8,245.2-492.3,1004.3-1553.1C1744-2586.7,2976.1-3725.4,4171.2-4478.6c348.4-218,657.9-369.8,792.2-383.5c124.6-11.7,276.4,44.8,589.8,219.9C6579-4064,7853.9-2977.9,8663.6-1991.1C9516.2-953.6,9948.3,76.1,9895.7,940.3c-74,1220.4-955.7,2207.3-2160.6,2415.6c-219.9,37-611.2,37-844.7,0c-747.4-120.7-1469.6-619-1818-1255.5c-35-64.2-70.1-116.8-75.9-116.8c-5.8,0-21.4,23.4-35,54.5c-116.8,255-531.4,712.4-819.5,903.2c-325.1,214.1-681.3,356.2-1031.6,414.6C2880.7,3392.8,2454.4,3390.9,2244.2,3353.9z" />
                        </g>
                      </g>
                    </svg> </button>
                </div>
              </div>
              <div class="property-content-wrapper">
                <div class="property-content text-right">
                  <div class="content">
                    <span class="code flex-nowrap">
                      <span>کد: {{ item.code }}</span>
                    </span>
                    <h1 class="title">
                      <a (click)="redirectToDetails(item._id)">{{ item.title }}</a>
                    </h1>
                    <p class="row address flex-nowrap">
                      <i class="material-icons text-muted">location_on</i>
                      <span>{{ item.state + "، " + item.city }}</span>
                    </p>
                    <div class="row justify-content-center" *ngIf="
                        item.transactionTypeID === '613be86ae83f7824dce7cadb'">
                      <h3 class="primary-color price">
                        <span>{{ item.price | number }} تومان</span>
                      </h3>
                    </div>

                    <div class="row justify-content-center"
                      *ngIf="item.transactionTypeID !== '613be86ae83f7824dce7cadb'">
                      <h3 class="primary-color price">
                        <span>رهن {{ item.priceMortgage | number }} -
                          اجاره {{ item.priceRent | number }} </span>
                      </h3>
                    </div>

                    <div class="features mt-3">
                      <p>
                        <span>{{ item.area }}</span><span><i class="fa fa-arrows" aria-hidden="true"></i>متراژ
                        </span>
                      </p>
                      <p>
                        <span>{{ item.age }}</span><span><i class="fa fa-calendar" aria-hidden="true"></i>سن ملک
                        </span>
                      </p>
                      <p>
                        <span> {{ item.bath }}</span><span><i class="fa fa-bath"></i>حمام</span>
                      </p>
                      <p>
                        <span>{{ item.bedroom }}</span>
                        <span><i class="fa fa-bed" aria-hidden="true"></i>اتاق خواب</span>
                      </p>
                    </div>
                  </div>

                  <div class="actions row justify-content-center mt-3">
                    <div class="col-6 align-self-center">
                      <p class="date mb-0">
                        <i class="material-icons text-muted">date_range</i>
                        <span class="mx-2">{{ item.date }}</span>
                      </p>
                    </div>
                    <div class="col-6 align-self-center d-flex flex-row-reverse">
                      <a class="white-flat-button" [routerLink]="['/property',item['_id']]">جزییات</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row justify-content-center mt-3 site-card" *ngIf="total === 0">
          <div class="bg-pagination w-100">
            <p class="text-center font-weight-bold py-3 mb-0">
              نتیجه جستجو یافت نشد.
            </p>
          </div>
        </div>
        <div class="row justify-content-center mt-3 site-card" *ngIf="total !== 0">
          <div class="col-md-12 col-sm-12 align-self-center">
            <pagination-controls (pageChange)="page = $event" class="theme-pagination p-3 text-center"
              [maxSize]="pageSize" previousLabel="قبلی" nextLabel="بعدی"></pagination-controls>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<p-sidebar [(visible)]="displayMobileFilter" [style]="{ width: '25em' }" position="left" [showCloseIcon]="true"
  [baseZIndex]="10000">
  <div class="text-center"></div>
  <div class="d-flex flex-column">
    <div class="mb-auto">
      <div class="container">
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-dropdown [options]="transactionTypes" placeholder="نوع آگهی" [(ngModel)]="selectedtransactionType"
              optionLabel="title"></p-dropdown>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-dropdown [options]="propertyTypes" placeholder="نوع کاربری" (onChange)="onTypeChange($event)"
              optionLabel="title"></p-dropdown>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-dropdown [options]="subPropertyTypes" placeholder="نوع ملک" (onChange)="onSubTypeChange($event)"
              optionLabel="title"></p-dropdown>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-multiSelect [options]="features" (onChange)="onChangeFeature($event)" placeholder="ویژگی ها"
              [(ngModel)]="selectedFeatures" optionLabel="title"></p-multiSelect>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-multiSelect [options]="conditions" (onChange)="onChangeCondition($event)" placeholder="شرایط"
              [(ngModel)]="selectedConditions" optionLabel="title"></p-multiSelect>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-12">
            <p-multiSelect [options]="exchanges" (onChange)="onChangeExchange($event)" placeholder="معاوضه با"
              [(ngModel)]="selectedExchanges" optionLabel="title"></p-multiSelect>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-6">
            <p-multiSelect [options]="baths" (onChange)="onChangeBath($event)" placeholder="حمام"
              [(ngModel)]="selectedbaths" optionLabel="title"></p-multiSelect>
          </div>
          <div class="col-6">
            <p-multiSelect [options]="rooms" (onChange)="onChangeRoom($event)" placeholder="اتاق خواب"
              [(ngModel)]="selectedrooms" optionLabel="title"></p-multiSelect>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-6">
            <p-inputNumber (onInput)="onInputareaFrom($event)" [(ngModel)]="areaFrom" placeholder="متراژ از"
              mode="decimal" [minFractionDigits]="0">
            </p-inputNumber>
          </div>
          <div class="col-6">
            <p-inputNumber (onInput)="onInputareaTo($event)" [(ngModel)]="areaTo" placeholder="متراژ تا" mode="decimal"
              [minFractionDigits]="0">
            </p-inputNumber>
          </div>
        </div>
        <div class="row justify-content-center pb-3">
          <div class="col-6">
            <p-inputNumber (onInput)="onInputpriceFrom($event)" [(ngModel)]="priceFrom" placeholder="قیمت از"
              mode="decimal" [minFractionDigits]="0">
            </p-inputNumber>
          </div>
          <div class="col-6">
            <p-inputNumber (onInput)="onInputpriceTo($event)" [(ngModel)]="priceTo" placeholder="قیمت تا" mode="decimal"
              [minFractionDigits]="0">
            </p-inputNumber>
          </div>
        </div>
        <div class="row justify-content-center pb-3" [formGroup]="form">
          <div class="col-12">
            <p-chips placeholder=" کلمات کلیدی " [(ngModel)]="keywords" (onAdd)="onAddKey($event)"
              (onRemove)="onRemoveKey($event)" [addOnTab]="true" [addOnBlur]="true">
            </p-chips>
          </div>
        </div>
        <div class="row justify-content-center p-3">
          <div class="col-6">
            <button (click)="searchProperty()" class="green-button" type="submit">
              <i class="fa fa-search"></i>
              جستجو
            </button>
          </div>
          <div class="col-6">
            <button (click)="goProperty(0, 0, 0)" class="white-flat-button" type="submit"> همه املاک
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</p-sidebar>